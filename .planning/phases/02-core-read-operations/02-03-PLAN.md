---
phase: 02-core-read-operations
plan: 03
type: execute
depends_on: []
files_modified: [cmd/threads.go]
---

<objective>
Implement threads list and get commands for reading Gmail conversation threads.

Purpose: Enable users to list conversation threads and view all messages in a thread.
Output: Working `gsuite threads list` and `gsuite threads get` commands.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
@.planning/phases/01-foundation/01-03-SUMMARY.md
@internal/auth/auth.go
@cmd/whoami.go
@cmd/root.go

**Tech stack available:** Go, Cobra CLI, google.golang.org/api/gmail/v1
**Established patterns:** Cobra command in cmd/, auth via auth.NewGmailService(), getter functions from root.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create threads command with list and get subcommands</name>
  <files>cmd/threads.go</files>
  <action>
Create cmd/threads.go with:

1. Parent `threadsCmd` cobra command at "threads" for grouping
2. `threadsListCmd` subcommand at "list":
   - Get credentials and user from root flags
   - Create Gmail service via auth.NewGmailService()
   - Call service.Users.Threads.List("me") with flags:
     - --max-results/-n (default 10, max 500)
     - --label-ids (comma-separated filter)
     - --query/-q (Gmail search query)
   - Print thread ID, snippet, and message count for each result
   - Handle pagination (show "More results available" if NextPageToken)

3. `threadsGetCmd` subcommand at "get":
   - Require thread ID as positional argument
   - Get credentials and user from root flags
   - Create Gmail service
   - Call service.Users.Threads.Get("me", threadID).Format("full").Do()
   - For each message in thread, print:
     - Message separator line
     - From, To, Date, Subject headers
     - Body content (prefer text/plain, decode base64url)
   - Show messages in chronological order (oldest first)

Use same error handling pattern as whoami.go.
Register all commands in init().
  </action>
  <verify>
go build -o gsuite . && ./gsuite threads --help && ./gsuite threads list --help && ./gsuite threads get --help && go vet ./...
  </verify>
  <done>
- `gsuite threads list` shows help with --max-results, --label-ids, --query flags
- `gsuite threads get` shows help requiring thread ID argument
- go vet passes
- Binary builds without errors
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build -o gsuite .` succeeds
- [ ] `./gsuite threads --help` shows subcommands (list, get)
- [ ] `./gsuite threads list --help` shows flags
- [ ] `./gsuite threads get --help` shows usage with thread ID
- [ ] `go vet ./...` passes
</verification>

<success_criteria>

- Threads list command implemented with filtering flags
- Threads get command shows full conversation with all messages
- Same auth pattern as existing commands
- No build or vet errors
- Phase 2 complete
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-read-operations/02-03-SUMMARY.md`
</output>
